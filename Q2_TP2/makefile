#------------------------------------------------------------------------------
#	TARGET
#------------------------------------------------------------------------------
TARGET := app

#------------------------------------------------------------------------------
#	DIRECTORIES
#------------------------------------------------------------------------------
BUILD_DIR := ./build
SRC_DIR := ./src
INCLUDE_DIR := ./include

#------------------------------------------------------------------------------
#	CPP FLAGS
#------------------------------------------------------------------------------
CC := gcc
# DEBUG?=""
CFLAG := -Wall  -Werror $(DEBUG)

#------------------------------------------------------------------------------
#	MAKE
#------------------------------------------------------------------------------
SRCS := $(shell find $(SRC_DIR) -name '*.c')
OBJS := $(SRCS:%=$(BUILD_DIR)/%.o)

$(BUILD_DIR)/$(TARGET): $(OBJS)
	@echo "The final build step..."
	$(CC) $(OBJS) -o $@

$(BUILD_DIR)/%.c.o: %.c
	@echo "Build step for C source:" $@
	@mkdir -p $(dir $@)
	$(CC) $(CFLAG) -c $< -o $@

.PHONY: run
run:
	@echo "Start-up..."
	@./$(BUILD_DIR)/$(TARGET)

.PHONY: clean
clean:
	@echo "Cleaning previous build..."
	@rm -r $(BUILD_DIR)
